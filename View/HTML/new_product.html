{% extends 'admin_page.html' %}
{% block head %}
<title>New Product</title>

{% endblock %}
{% block body %}
<style>
  .new_product {
  margin-left: 230px;
  margin-right: 30px;
  height: auto;
  width: calc(100% - 230px);
  top: 55px;
  bottom:40px;
  position: fixed;
  overflow-x: hidden;
  overflow-y: scroll
}
.new_product li {
  padding-top: 0px;
  vertical-align: top;
  text-align: left;
  margin-top: 10px;
}
.new_product p {
  margin-top: 0px;
  font-size: 15px;
  font-weight: 500;
  display: inline-block;
  width: 210px;
}
.new_product textarea {
  display: inline-block;
  width: calc(100% - 230px);
  font-size: 15px;
  vertical-align: top;
  text-align: left;
  resize: none;
  font-family: Arial, Helvetica, sans-serif;
}
.new-product-btn {
  height: 40px;
  width: 140px;
  float: right;
  padding-bottom: 0px;
  text-decoration: none;
  display: block;
  margin-top: 40px;
  margin-right: 20px;
  font-size: 17px;
  text-align: center;
  font-weight: 600;
  padding-right: 20px;
  transition-duration: 0.4s;
  cursor: pointer;
  color: white;
  background-color: #1E5D63;
  border: 2px solid #1E5D63;

}
.new-product-btn:hover{
  text-decoration: none;
  background-color: white;
  color: #1E5D63;
}

.tag_li {
  display: inline;
  margin-left: 5px;
  margin-right: 5px;
  border-radius: 5px;
  padding-left: 10px;
  padding-right: 5px;
  width: auto;
  margin-top:5px;
}
</style>
<div class="new_product">
  <form action="{{ url_for('create_new_product') }}" method="post" enctype="multipart/form-data">
  <ul>
    <li style="height:40px;"><h2>New Product</h2></li>
    <li style="height:50px;margin-top:20px;"><p>Product Name</p><textarea name='product_name' type="text" placeholder=""></textarea></li>
    <li style="height:50px;margin-top:20px;"><p>Product Category</p><textarea name='product_category' type="text" placeholder=""></textarea></li>
    <li style="height:50px;margin-top:20px;"><p>Product Price</p><textarea name='product_price' type="text" placeholder=""></textarea></li>
    <li style="height:180px;"><p>Product Description</p><textarea name='product_description' style="height:160px;" type="text" placeholder=""></textarea></li>
    <li style="height:50px;">
      <p>Product Tag</p>
      <input id="tag_input" type="text" placeholder="">
      <input id="tag_list" name="tag" type="text" style="display:none;">
      <button id="enter_tag_button" type="button" name="button" onclick=enter_tag()>Add</button>
      <div style="display:inline-block;width:calc(100% - 200px);margin-left:200px;overflow: auto;white-space: nowrap;" id="tag_div">
      </div>
      <script type="text/javascript">
        var tag_input = document.getElementById("tag_input");
        tag_input.addEventListener("keyup", function(event) {
          if (event.keyCode == 13) {
            event.preventDefault();
            if (tag_input.value.length > 0) {
              document.getElementById("enter_tag_button").click();
            }
          }
        });
        function enter_tag() {
          if (tag_input.value.length > 0) {
              var div = document.getElementById('tag_div');
              const list = document.createElement("LI");
              list.className = "tag_li"
              var colors = ['#FBF8F1', '#FDEBF7', '#EFDAD7', '#C0D8C0', '#FFE162', '#D9D7F1', '#E7FBBE', '#F5F5F5', '#FDF5CA'];
              list.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
              const list_text = document.createTextNode(tag_input.value);
              const remove_tag_btn = document.createElement('button');
              remove_tag_btn.style.border = "none";
              remove_tag_btn.style["background-color"] = "transparent";
              remove_tag_btn.innerHTML = '<img src="../../../../static/images/remove_button.png" style="width:10px;height:10px;" />';
              remove_tag_btn.onclick =  function(){
                list.parentNode.removeChild(list);
              };
              list.appendChild(list_text);
              list.appendChild(remove_tag_btn);
              div.appendChild(list);

          }

        }
        document.addEventListener('keypress', function (e) {
            if (e.keyCode === 13 || e.which === 13) {
                e.preventDefault();
                return false;
            }

        });
      </script>
    </li>
    <li style="height:50px;margin-top:20px;"><p>Product Stock</p><textarea name='product_stock' type="text" placeholder=""></textarea></li>
    <li style="height:50px;"><p>Product Image</p><input name='product_image' type="file" placeholder=""></li>
    <br><img id="product_img" src="#">
    <script type="text/javascript">
      window.addEventListener('load', function() {
        document.querySelector('input[type="file"]').addEventListener('change', function() {
          if (this.files && this.files[0]) {
            var img = document.getElementById("product_img");

              img.src = URL.createObjectURL(this.files[0]); // set src to blob url

            }
          });
        });

    </script>
    <li style="height:50px;"><button onclick="create()" value="Create" class="new-product-btn" id="create_btn">Create</button></li>
    <script type="text/javascript">
        function create() {
          var tag_lists = document.getElementsByClassName('tag_li');
          var tags = "";
          for (var i = 0; i < tag_lists.length; i++) {
            if (tags.length == 0) {
              tags=tag_lists[i].innerText;
            } else {
              tags = tags + "," +tag_lists[i].innerText;
            }

          }
          document.getElementById("tag_list").value = tags;
          document.getElementById("create_course_form").submit();
        }
    </script>

  </ul>
</form>
</div>
{% endblock %}
